# ___  ________          ________  ________  ________   ________ ___  ________     
#|\  \|\_____  \        |\   ____\|\   __  \|\   ___  \|\  _____\\  \|\   ____\    
#\ \  \|____|\ /_       \ \  \___|\ \  \|\  \ \  \\ \  \ \  \__/\ \  \ \  \___|    
# \ \  \    \|\  \       \ \  \    \ \  \\\  \ \  \\ \  \ \   __\\ \  \ \  \  ___  
#  \ \  \  __\_\  \       \ \  \____\ \  \\\  \ \  \\ \  \ \  \_| \ \  \ \  \|\  \ 
#   \ \__\|\_______\       \ \_______\ \_______\ \__\\ \__\ \__\   \ \__\ \_______\
#    \|__|\|_______|        \|_______|\|_______|\|__| \|__|\|__|    \|__|\|_______|

# ##################
# ##################

###############
# Core Settings #
###############

# Set modern defaults
default_border pixel 2
default_floating_border pixel 2
hide_edge_borders none

# Focus follows mouse
focus_follows_mouse yes

# Mouse warping
mouse_warping output

# Popup handling
popup_during_fullscreen smart

# Workspace auto back and forth
workspace_auto_back_and_forth yes

# Show marks on window decoration
show_marks yes

###############
# Keybindings #
###############

# Mod Key Binding
set $mod Mod4

# Use Mouse+$mod to drag floating windows
floating_modifier $mod

# Modern terminal launcher
bindsym $mod+Return exec --no-startup-id kitty

# Kill focused window
bindsym $mod+Shift+q kill

# Modern program launcher
bindsym $mod+d exec --no-startup-id rofi -show drun -show-icons
bindsym $mod+Shift+d exec --no-startup-id rofi -show run

# Context menu
bindsym --whole-window $mod+button3 exec --no-startup-id ~/.config/scripts/xmenu.sh

# Clipboard manager
bindsym $mod+Shift+c exec --no-startup-id "rofi -modi 'clipboard:greenclip print' -show clipboard"

# Window management
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# Split modes
bindsym $mod+b split h
bindsym $mod+v split v

# Fullscreen
bindsym $mod+f fullscreen toggle

# Layout modes
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# Floating toggle
bindsym $mod+Shift+space floating toggle
bindsym $mod+space focus mode_toggle

# Focus parent/child
bindsym $mod+a focus parent

# Mouse bindings
bindsym --border button2 kill
bindsym --border button3 floating toggle

# System controls
bindsym $mod+Shift+r restart
bindsym $mod+Shift+e exec "i3-nagbar -t warning -m 'Exit i3?' -B 'Yes, exit i3' 'i3-msg exit'"

# Modern resize mode
mode "resize" {
    bindsym h resize shrink width 10 px or 10 ppt
    bindsym j resize grow height 10 px or 10 ppt
    bindsym k resize shrink height 10 px or 10 ppt
    bindsym l resize grow width 10 px or 10 ppt

    bindsym Left resize shrink width 10 px or 10 ppt
    bindsym Down resize grow height 10 px or 10 ppt
    bindsym Up resize shrink height 10 px or 10 ppt
    bindsym Right resize grow width 10 px or 10 ppt

    bindsym Return mode "default"
    bindsym Escape mode "default"
    bindsym $mod+r mode "default"
}

bindsym $mod+r mode "resize"

################
# OCCULT WORKSPACES - Unicode Safe
################
set $ws1 "1:Main"
set $ws2 "2:IDE"
set $ws3 "3:Hell" 
set $ws4 "4:Satan"
set $ws5 "5:Void"
set $ws6 "6:Curse"
set $ws7 "7:Doom"
set $ws8 "8:Music"
set $ws9 "9:Discord"

# Modern monitor assignment (using correct monitor name)
workspace $ws1 output HDMI-0
workspace $ws2 output HDMI-0
workspace $ws3 output HDMI-0
workspace $ws4 output HDMI-0
workspace $ws5 output HDMI-0
workspace $ws6 output HDMI-0
workspace $ws7 output HDMI-0
workspace $ws8 output HDMI-0
workspace $ws9 output HDMI-0

# Workspace switching
bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $ws8
bindsym $mod+9 workspace $ws9

# Move containers to workspaces
bindsym $mod+Shift+1 move container to workspace $ws1
bindsym $mod+Shift+2 move container to workspace $ws2
bindsym $mod+Shift+3 move container to workspace $ws3
bindsym $mod+Shift+4 move container to workspace $ws4
bindsym $mod+Shift+5 move container to workspace $ws5
bindsym $mod+Shift+6 move container to workspace $ws6
bindsym $mod+Shift+7 move container to workspace $ws7
bindsym $mod+Shift+8 move container to workspace $ws8
bindsym $mod+Shift+9 move container to workspace $ws9

#############
# MODERN APPEARANCE - DYNAMIC PYWAL COLORS
#############
include ~/.config/i3/colors

# Modern gaps configuration
gaps inner 3 
gaps outer 1

# Smart gaps (no gaps when only one container)
smart_gaps on

# Smart borders (no borders when only one container)
smart_borders on

#############
# MODERN APPLICATION RULES
#############

# Floating applications
for_window [window_role="pop-up"] floating enable
for_window [window_role="bubble"] floating enable
for_window [window_role="task_dialog"] floating enable
for_window [window_role="Preferences"] floating enable
for_window [window_type="dialog"] floating enable
for_window [window_type="menu"] floating enable

# Modern scratchpad setup
for_window [instance="translate"] floating enable, move scratchpad, move position center
for_window [instance="calendar"] floating enable, move scratchpad, move position center

bindsym $mod+t [instance="translate"] scratchpad show
bindsym $mod+c [instance="calendar"] scratchpad show, resize set 1500 800

#############
# MODERN MEDIA CONTROLS
#############

# Hardware media keys
bindsym XF86AudioPlay exec --no-startup-id playerctl play-pause
bindsym XF86AudioNext exec --no-startup-id playerctl next
bindsym XF86AudioPrev exec --no-startup-id playerctl previous

# Modern volume controls with notifications
bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ +5% && notify-send "Volume" "$(pactl get-sink-volume @DEFAULT_SINK@ | grep -oP '\d+%' | head -1)"
bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ -5% && notify-send "Volume" "$(pactl get-sink-volume @DEFAULT_SINK@ | grep -oP '\d+%' | head -1)"
bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute @DEFAULT_SINK@ toggle && notify-send "Volume" "Toggled"

# Keyboard volume controls
bindsym $mod+Shift+plus exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ +5%
bindsym $mod+Shift+minus exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ -5%

#############
# ENHANCED CHAMELEON THEME SYSTEM
#############

# Quick theme changes
bindsym $mod+Shift+w exec --no-startup-id ~/.config/polybar/wal-reload $(find ~/Pictures -name "*.jpg" -o -name "*.png" | shuf -n1)
bindsym $mod+Shift+t exec --no-startup-id ~/.config/scripts/theme_selector.sh

# Wallpaper controls with variety integration
bindsym $mod+Shift+n exec --no-startup-id variety --next
bindsym $mod+Shift+p exec --no-startup-id variety --previous
bindsym $mod+Shift+z exec --no-startup-id variety --favorite

# Screenshot utilities
bindsym Print exec --no-startup-id maim -s | xclip -selection clipboard -t image/png && notify-send "Screenshot" "Copied to clipboard"
bindsym $mod+Print exec --no-startup-id maim | xclip -selection clipboard -t image/png && notify-send "Screenshot" "Full screen copied to clipboard"

#############
# MODERN STARTUP SEQUENCE
#############

# Essential services
exec_always --no-startup-id xset s off
exec_always --no-startup-id xset -dpms
exec_always --no-startup-id picom --config ~/.config/picom/picom.conf
exec_always --no-startup-id feh --bg-fill ~/Pictures/wp15589380.png
exec_always --no-startup-id xrandr --output HDMI-0 --mode 1920x1080 --rate 143.00

# Polybar with modern launch
exec_always --no-startup-id killall polybar; sleep 1; polybar -c ~/.config/polybar/config.ini main &

# Theme initialization
exec --no-startup-id ~/.config/polybar/wal-reload --reload

# Background services
exec --no-startup-id greenclip daemon
exec --no-startup-id variety

# Scratchpad applications
exec_always --no-startup-id kitty --class translate -e zsh -c 'trans -I'
exec_always --no-startup-id kitty --name calendar -e zsh -c 'ikhal'

#############
# MODERN WINDOW ASSIGNMENTS
#############

# Workspace 1: Browser (1:Hell)
assign [class="firefox"] $ws1
assign [class="Firefox"] $ws1
assign [class="Google-chrome"] $ws1
assign [class="Chromium"] $ws1
# Terminal assignments removed - terminals can now open in any workspace

# Workspace 2: Programming Editors (2:Demon)
assign [class="code"] $ws2
assign [class="Code"] $ws2
assign [class="cursor"] $ws2
assign [class="Cursor"] $ws2
assign [class="nvim"] $ws2
assign [class="Neovim"] $ws2
assign [class="vim"] $ws2
assign [class="Gvim"] $ws2

# Workspace 8: Music Applications (8:Chaos)
assign [class="Spotify"] $ws8
assign [class="spotify"] $ws8
assign [class="Rhythmbox"] $ws8
assign [class="Clementine"] $ws8
assign [class="Audacious"] $ws8
assign [class="VLC"] $ws8
assign [class="vlc"] $ws8

# Workspace 9: Discord (9:Abyss)
assign [class="discord"] $ws9
assign [class="Discord"] $ws9
assign [class="Vesktop"] $ws9

# Modern window behavior
for_window [urgent=latest] focus

#############
# QUICK WORKSPACE SHORTCUTS
#############

# Quick access to your main workspaces
bindsym $mod+Ctrl+b workspace $ws1  # Browser/Terminal
bindsym $mod+Ctrl+p workspace $ws2  # Programming
bindsym $mod+Ctrl+m workspace $ws8  # Music
bindsym $mod+Ctrl+d workspace $ws9  # Discord

# Quick move to your main workspaces
bindsym $mod+Ctrl+Shift+b move container to workspace $ws1  # Browser/Terminal
bindsym $mod+Ctrl+Shift+p move container to workspace $ws2  # Programming
bindsym $mod+Ctrl+Shift+m move container to workspace $ws8  # Music
bindsym $mod+Ctrl+Shift+d move container to workspace $ws9  # Discord

#############
# KEYBIND REFERENCE
#############
# Active Bindings:
# $mod+Return = Terminal
# $mod+d = App launcher
# $mod+Shift+d = Run launcher  
# $mod+Shift+q = Kill window
# $mod+Shift+c = Clipboard
# $mod+hjkl = Focus movement
# $mod+Shift+hjkl = Move windows
# $mod+bv = Split horizontal/vertical
# $mod+f = Fullscreen
# $mod+swe = Layout modes
# $mod+space = Focus tiling/floating
# $mod+Shift+space = Toggle floating
# $mod+a = Focus parent
# $mod+r = Resize mode
# $mod+1-9 = Switch workspace
# $mod+Shift+1-9 = Move to workspace
# $mod+t = Translator scratchpad
# $mod+c = Calendar scratchpad
# $mod+Shift+w = Random wallpaper
# $mod+Shift+t = Theme selector
# $mod+Shift+n/p = Next/prev wallpaper
# $mod+Shift+z = Favorite wallpaper
# $mod+Shift+r = Restart i3
# $mod+Shift+e = Exit i3
# Print = Screenshot selection
# $mod+Print = Screenshot full
# $mod+Ctrl+b/p/m/d = Quick workspace access (Browser/Programming/Music/Discord)
# $mod+Ctrl+Shift+b/p/m/d = Quick move to workspace
